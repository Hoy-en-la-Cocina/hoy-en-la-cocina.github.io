<!DOCTYPE html>
<html lang="{{ site.lang | default: "en-US" }}">
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=640">

    <link rel="stylesheet" href="{{ '/assets/css/style.css?v=' | append: site.github.build_revision | relative_url }}" media="screen">
    <link rel="stylesheet" href="{{ '/assets/css/mobile.css' | relative_url }}" media="only screen and (max-width:640px)">
    <link rel="stylesheet" href="{{ '/assets/css/non-screen.css' | relative_url }}" media="only screen and (max-width:640px)">

    <script src="{{ '/assets/js/modernizr.js' | relative_url }}"></script>
    <script src="https://code.jquery.com/jquery-1.12.4.min.js" integrity="sha256-ZosEbRLbNQzLpnKIkEdrPv7lOy9C27hHQ+Xp8a4MxAQ=" crossorigin="anonymous"></script>
    <script src="{{ '/assets/js/headsmart.min.js' | relative_url }}"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script>
      $(document).ready(function () {
        $('#main_content').headsmart()
      })
    </script>

    <title>Hoy, en la Cocina</title>
    <link rel="icon" href="/assets/apuchef.png" type="image/png">

{% seo %}

{% include head-custom.html %}
    <style>
      /* The box that appears */
      body {
            text-align: center;
            margin: 30px;
            padding-bottom: 20px;
        }
        .box {
          display: none; /* Initially hidden */
          position: fixed;
          top: 30%;
          left: 50%;
          transform: translate(-50%, -50%); /* Centers both horizontally & vertically */
          background-color: #333;
          color: white;
          padding: 20px;
          border-radius: 10px;
          box-shadow: 0px 4px 6px rgba(0, 0, 0, 0.1);
        }

        /* Close button inside the box */
        .close-btn {
            cursor: pointer;
            background: red;
            color: white;
            border: none;
            padding: 5px 10px;
            margin-top: 10px;
            border-radius: 5px;
        }
      /* Save button inside the box */
        .save-btn {
            cursor: pointer;
            background: green;
            color: white;
            border: none;
            padding: 5px 10px;
            margin-top: 10px;
            border-radius: 5px;
        }

        .fancy-border {
          /*display: inline-block;*/
          font-size: 20px;
          border: 2px solid #7C334F; 
          padding: 5px;
        }

      .ingredient-line {
        display: grid;
        grid-template-columns: 1fr auto;
        align-items: center;
        gap: 10px;
        margin: 5px 0;
      }

      .ingredient-name {
        overflow-wrap: anywhere;
      }

      .ingredient-controls {
        display: flex;
        align-items: center;
        gap: 5px;
      }
      
      input[type="radio"] {
        margin-left: auto;
      }


  #subtotal-box {
    position: fixed;
    bottom: 0;
    left: 50%;
    transform: translateX(-50%);
    width: 43%;
    background-color: #fff;
    border-top: 2px solid #ccc;
    padding: 10px 0;
    box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.1);
    z-index: 1000;
    display: flex;
    justify-content: center;
    border-radius: 12px 12px 0 0;
    min-width: 600px;
  }

  .subtotal-content {
    display: flex;
    flex-direction: row;
    align-items: center;
    justify-content: center;
    gap: 180px;
    width: 100%;
  }

  .subtotal-text {
    font-weight: 500;
    font-size: 1.2em;
    margin-right: 10px;
  }

  .checkout-btn {
    padding: 10px 20px;
    background-color: #28a745;
    color: white;
    border: none;
    border-radius: 8px;
    font-weight: bold;
    cursor: pointer;
    transition: background-color 0.2s ease-in-out;
    margin-right: 2px;
  }

  .checkout-btn:hover {
    background-color: #218838;
  }

  .edit-btn {
    padding: 10px 20px;
    background-color: #6c757d;
    color: white;
    border: none;
    border-radius: 8px;
    font-weight: bold;
    cursor: pointer;
    transition: background-color 0.2s ease-in-out;
  }

  .edit-btn:hover {
    background-color: #495057;
  }

  .order-summary-box {
    position: fixed;
    bottom: 50%;
    left: 50%;
    transform: translateX(-50%);
    width: 50%;
    max-height: 800px;
    overflow-y: auto;
    background: white;
    border: 2px solid #ccc;
    border-radius: 12px;
    box-shadow: 0px 4px 20px rgba(0,0,0,0.1);
    padding: 20px;
    z-index: 999;
  }

  .order-summary-box h3 {
    margin-top: 0;
  }

  .dish-button {
    width: 30%;             /* Full width */
    height: 50px;            /* Set height (you can change this value) */
    font-size: 20px;         /* Font size */
    text-align: center;      /* Center text */
    white-space: nowrap;     /* Prevent text wrapping */
    overflow: hidden;        /* Hide overflow */
    text-overflow: ellipsis; /* Add "..." if text is too long */
    display: flex;           /* Make button content flexible */
    align-items: center;     /* Vertically center the text */
    justify-content: center; /* Horizontally center the text */
  }

    </style>
  </head>

  <body>
    <div class="shell">

      <header>
        <div class="ribbon-outer">
          <div class="ribbon-inner">
            <h1>Hoy, en la Cocina</h1>
            <h2>{{ site.description | default: site.github.project_tagline }}</h2>
          </div>
          <span class="left-tail"></span>
          <span class="right-tail"></span>
        </div>
      </header>

      {% if site.show_downloads %}
        <section id="downloads">
          <span class="inner">
            <a href="{{ site.github.zip_url }}" class="zip"><em>download</em> .ZIP</a><a href="{{ site.github.tar_url }}" class="tgz"><em>download</em> .TGZ</a>
          </span>
        </section>
      {% else %}
        <div id="no-downloads">
          <span class="inner">
          </span>
        </div>
      {% endif %}


      <span class="banner-fix"></span>
      <div id="template" style="display:none; position:fixed"></div>

      <section id="main_content">
      <div id="popupBox" class="box">
        <div id="boxtext"></div>
        <br>
        <button class="close-btn" onclick="hidepopBox()">Close</button>
      </div>
     
      <div id="addBox" class="box">
        <h2>Options</h2>
          <div id="ingredients-list-radio"></div>
        <br>
        <h2>Extras</h2>
          <div id="ingredients-list"></div>
        <br>
        <h2>Custom Request:</h2>
          <textarea 
          id="customRequest"
          rows="4" 
          cols="50" 
          placeholder="Type here..."
          style="resize: vertical; font-size: 16px; padding: 8px;"></textarea>

        <br>
        <div id="totals"></div>
        <div style="display: flex; flex-direction: column; align-items: center; gap: 0px;">
          <p id="NoOption"; style="color:red;"></p>
          <button class="save-btn" onclick="saveSelection()">Add to Order</button>
          <button class="close-btn" onclick="hideaddBox()">Cancel</button>
        </div>
      </div>

      <div id="orderSummaryBox" style="display: none;" class="order-summary-box">
        <div id="summaryContent">
          <img src="/assets/apuchef.jpg" width="50%">
          <h3>Your Order</h3>
          <ul id="orderList"></ul>
          <h3 id="receiptTotals"></h3>
        </div>
        <button class="close-btn" onclick="hideOrderSummary()">Close</button>
      </div>

      <div id="editBox" style="display: none;" class="order-summary-box">
        <div id="editContent">
          <h3>Your Order</h3>
          <ul id="editOrderList"></ul>
          <h3 id="editReceiptTotals"></h3>
        </div>
        <button class="close-btn" onclick="hideEditBox()">Close</button>
      </div>

      <div id="subtotal-box">
        <div class="subtotal-text">
          Subtotal: $<span id="subtotal-amount">0.00</span>
        </div>
        <button class="checkout-btn" onclick="toggleOrderSummary()">Show Receipt</button>
        <button class="edit-btn" onclick="toggleEditBox()">Edit Order</button>
      </div>
      

        <p><b style="font-size:36px;">BREAKFAST</b></p>
        
        <div class="fancy-border" style="border-bottom: none;">
          <p id="french toast"></p>
          <div style="display: flex; justify-content: center; gap: 10px;">
            <button class="dish-button" onclick="showBox(0,'french_toast')">Description</button>
            <button class="dish-button" onclick="showBox(1,'french_toast')">Add to Order</button>
          </div>
        </div>
        <div class="fancy-border">
          <p id="fried egg"></p>
          <div style="display: flex; justify-content: center; gap: 10px;">
            <button class="dish-button" onclick="showBox(0, 'egg_fried')">Description</button>
            <button class="dish-button" onclick="showBox(1, 'egg_fried')">Add to Order</button>
          </div>
        </div>

        <p><b style="font-size:36px;">EMPANADAS</b></p>
        
        <div class="fancy-border" style="border-bottom: none;">
          <p id="ham and cheese"></p>
          <div style="display: flex; justify-content: center; gap: 10px;">
            <button class="dish-button" onclick="showBox(0,'ham_and_cheese')">Description</button>
            <button class="dish-button" onclick="showBox(1,'ham_and_cheese')">Add to Order</button>
          </div>
        </div>
        <div class="fancy-border" style="border-bottom: none;">
          <p id="chaparrita"></p>
          <div style="display: flex; justify-content: center; gap: 10px;">
            <button class="dish-button" onclick="showBox(0, 'chaparrita')">Description</button>
            <button class="dish-button" onclick="showBox(1, 'chaparrita')">Add to Order</button>
          </div>
        </div>
        <div class="fancy-border" style="border-bottom: none;">
          <p id="green curry empanada"></p>
          <div style="display: flex; justify-content: center; gap: 10px;">
            <button class="dish-button" onclick="showBox(0, 'green_curry_empanada')">Description</button>
            <button class="dish-button" onclick="showBox(1, 'green_curry_empanada')">Add to Order</button>
          </div>
        </div>
        <div class="fancy-border">
          <p id="custom empanada"></p>
          <div style="display: flex; justify-content: center; gap: 10px;">
            <button class="dish-button" onclick="showBox(0, 'custom_empanada')">Description</button>
            <button class="dish-button" onclick="showBox(1, 'custom_empanada')">Add to Order</button>
          </div>
        </div>

        <p><b style="font-size:36px;">PASTA</b></p>
        
        <div class="fancy-border">
          <p id="pizza"></p>
          <div style="display: flex; justify-content: center; gap: 10px;">
            <button class="dish-button" onclick="showBox(0,'pizza')">Description</button>
            <button class="dish-button" onclick="showBox(1,'pizza')">Add to Order</button>
          </div>
        </div>
        
        <p><b style="font-size:36px;">PASTA</b></p>
        
        <div class="fancy-border" style="border-bottom: none;">
          <p id="carbonara"></p>
          <div style="display: flex; justify-content: center; gap: 10px;">
            <button class="dish-button" onclick="showBox(0,'carbonara')">Description</button>
            <button class="dish-button" onclick="showBox(1,'carbonara')">Add to Order</button>
          </div>
        </div>
        <div class="fancy-border" style="border-bottom: none;">
          <p id="roasted pepper"></p>
          <div style="display: flex; justify-content: center; gap: 10px;">
            <button class="dish-button" onclick="showBox(0, 'roasted_pepper_sauce')">Description</button>
            <button class="dish-button" onclick="showBox(1, 'roasted_pepper_sauce')">Add to Order</button>
          </div>
        </div>
        <div class="fancy-border">
          <p id="putanesca"></p>
          <div style="display: flex; justify-content: center; gap: 10px;">
            <button class="dish-button" onclick="showBox(0, 'putanesca')">Description</button>
            <button class="dish-button" onclick="showBox(1, 'putanesca')">Add to Order</button>
          </div>
        </div>
        <p><b style="font-size:36px;">OTHER</b></p>
        <div class="fancy-border" style="border-bottom: none;">
        <p id="gumbo"></p>
          <div style="display: flex; justify-content: center; gap: 10px;">
            <button class="dish-button" onclick="showBox(0, 'gumbo')">Description</button>
            <button class="dish-button" onclick="showBox(1, 'gumbo')">Add to Order</button>
          </div>
        </div>
        <div class="fancy-border" style="border-bottom: none;">
        <p id="buffalo wings"></p>
          <div style="display: flex; justify-content: center; gap: 10px;">
            <button class="dish-button" onclick="showBox(0, 'buffalo_wings')">Description</button>
            <button class="dish-button" onclick="showBox(1, 'buffalo_wings')">Add to Order</button>
          </div>
        </div>
        <div class="fancy-border">
          <p id="egg"></p>
          <div style="display: flex; justify-content: center; gap: 10px;">
            <button class="dish-button" onclick="showBox(0, 'egg')">Description</button>
            <button class="dish-button" onclick="showBox(1, 'egg')">Add to Order</button>
          </div>
        </div>

        <p><b style="font-size:36px;">Bebidas</b></p>
        <div class="fancy-border">
        <p id="banana smoothie"></p>
          <div style="display: flex; justify-content: center; gap: 10px;">
            <button class="dish-button" onclick="showBox(0, 'banana_smoothie')">Description</button>
            <button class="dish-button" onclick="showBox(1, 'banana_smoothie')">Add to Order</button>
          </div>
        </div>
        
      </section>

      <footer>
        <span class="ribbon-outer">
          <span class="ribbon-inner">
              <p id="random"></p>
          </span>
          <span class="left-tail"></span>
          <span class="right-tail"></span>
        </span>
      </footer>

    </div>
  </body>

<script>
  var price_total = 0;
  var cal_total = 0;
  var ingredient_dict = {
  egg: { // Count
    name: 'Egg',
    price: 3190 / 12.0,
    cals: 155
  },
  egg_white: { // Count
    name: 'Egg White',
    price: 3190 / 12.0,
    cals: 17
  },
  egg_yolk: { // Count
    name: 'Egg Yolk',
    price: 3190 / 12.0,
    cals: 55
  },
  fettucine: { // Serving
    name: 'Fettucine',
    price: 990 / 5.0,
    cals: 270
  },
  parmesan: { // Grams
    name: 'Parmesan',
    price: 4250 / 145.0,
    cals: 94.8 * 5 / 145.0
  },
  bacon_thin: { // Count
    name: 'Thin Bacon',
    price: 3190 / 15.0,
    cals: 50
  },
  garlic: { // Teeth
    name: 'Garlic',
    price: 1090 / 27.0,
    cals: 12.4
  },
  olive_oil: { // Milliliters
    name: 'Olive Oil',
    price: 13850 / 1000.0,
    cals: 8210 / 1000.0
  },
  red_pepper: { // Count
    name: 'Red Pepper',
    price: 1690,
    cals: 40
  },
  pistaccio: { // Grams
    name: 'Piscaccio',
    price: 2350 / 80.0,
    cals: 600 / 100.0
  },
  tomato: { // Count
    name: 'Tomato',
    price: 1075 / 2.5,
    cals: 22
  },
  onion: { // Grams
    name: 'Onion',
    price: 775 / 1.2,
    cals: 44
  },
  flour: { // Grams
    name: 'Flour',
    price: 1000 / 1000.0,
    cals: 340 / 100
  },
  longaniza: { // Count
    name: 'Longaniza',
    price: 4290 / 4.0,
    cals: 369
  },
  shrimp_large: { // Grams, unit is 500 grams
    name: 'Large Shrimp',
    price: 7990 / 500.0,
    cals: 68 / 100.0
  },
  celery: { // Grams, one thing is 1500 grams
    name: 'Celery',
    price: 1390 / 1500.0,
    cals: 16 / 100.0
  },
  rice_white: { // Cups, serving is like 1/4 cup
    name: 'White Rice',
    price: 2690 / 5.0,
    cals: 167.5 / 0.25
  },
  capers: { // Grams, one thing is 240 grams
    name: 'Capers',
    price: 2990 / 240.0,
    cals: 34 / 100.0
  },
  tomatos_canned: { // Grams, one thing is 380 grams
    name: 'Canned Tomatos',
    price: 1750 / 380.0,
    cals: 22 / 100.0
  },
  anchovies: { // Grams, one thing is 240 grams
    name: 'anchovies',
    price: 6890 / 240.0,
    cals: 175 / 100.0
  },
  olives_black: { // Grams, one thing is 200 grams
    name: 'Black Olives',
    price: 1890 / 200.0,
    cals: 239 / 100.0
  },
  wings_flats: { // Count
    name: 'Wings (Flats)',
    price: 4190 / 24.0,
    cals: 140.8 / 3
  },
  hot_sauce_hot: { // Grams, one thing is 250 grams
    name: 'Spicy Hot Sauce',
    price: 2290 / 250,
    cals: 19 / 100.0
  },
  hot_sauce_mild: { // Grams, one thing is 250 grams
    name: 'Mild Hot Sauce',
    price: 1990 / 250,
    cals: 80 / 100.0
  },
  butter: { // Grams, one thing is 250 grams
    name: 'Butter',
    price: 2950 / 250,
    cals: 740 / 100
  },
  misc: { // Pesos, just for adding to the price for spices i don't care to do the math for
    name: 'misc',
    price: 1,
    cals: 0
  },
  sugar: { // Grams, one thing is 1 kg
    name: 'Sugar',
    price: 1250 / 1000.0,
    cals: 400 / 100.0
  },
  milk: { // Cups, one thing is 4.22 cups
    name: 'Milk',
    price: 1000 / 4.22,
    cals: 59 / 118.0
  },
  marraqueta: { // Count, remember 1 is half a thing
    name: 'Marraqueta',
    price: 200,
    cals: 268
  },
  syrup_gringo: { // Milliliters, one thing is 710
    name: 'Gringo Syrup',
    price: 3490 / 710.0,
    cals: 333 / 100
  },
  chocolate: { //Grams
    name: 'Chocolate',
    price: 1500/150.0,
    cals: 400/100.0,
  },
  coffee: { //Grams
    name: 'Coffee',
    price: 5690/220.0,
    cals: 3/100.0,
  },
  cinnamon: { //Grams
    name: 'Cinnamon',
    price: 570/15.0,
    cals: 137/100.0,
  },
  corbatas: { //Servings
    name: "Corbatas",
    price: 990/5.0,
    cals: 270.4
  },
  spaghetti: { //Servings
    name: "Spaghetti",
    price: 990/5.0,
    cals: 270.4,
  },
  tallarines: { //Servings 
    name: "Tallarines No77",
    price: 990/5.0,
    cals: 270.4,
  },
  bucatini: { //Servings
    name: "Bucatini",
    price: 1890/6,
    cals: 280.8
  },
  spirals: { //Servings
    name: "Spirals",
    price: 990/5.0,
    cals: 270.4,
  },
  macaroni: { //Servings
    name: "Macaroni",
    price: 990/5.0,
    cals: 270.4,
  },
  pantrucas: { //Servings
    name: "Pantrucas",
    price: 990/5.0,
    cals:270.4,
  },
  ham: { //Grams
    name: "Ham",
    price: 2090/250.0,
    cals: 102/100.0
  },
  mantecoso: { //Grams
    name: "Queso Mantecoso",
    price: 4490/350.0,
    cals: 351/100.0,
  },
  cheese_blue: { //Grams
    name: "Bleu Cheese",
    price: 3650/100.0,
    cals: 343/100.0,
  },
  cheese_mozzarella: { //Grams, one thing is 500
    name: "Real Mozzarella",
    price: 9250/500.0,
    cals: 272/100.0,
  },
  quesillo: { //Grams, one thing is 160
    name: "Quesillo",
    price: 2190/320.0,
    cals: 138/100,
  },
  hot_dog: { //Count
    name: "Hot Dog",
    price: 1190/5.0,
    cals: 83.5,
  },
  none: { //this is for programming purposes
    name: "None",
    price: 0,
    cals: 0,
  },
  banana: { //Count
    name: "Banana",
    price: 745/3.5,
    cals: 89
  },
  stevia: { //ml
    name: "Stevia",
    price: 4590/400.0,
    cals: 13/100.0
  },
  yoghurt: { //Grams, one thing is 1000
    name: "Yoghurt",
    price: 1959/1000.0,
    cals: 59/100.0
  },
  peanut_butter: { //Grams, one thing is 1130
    name: "Creamy Peanut Butter",
    price: 9490/1130.0,
    cals: 576/100.0
  },
  chicken_breast: { // Grams, one thing is 850
    name: "Chicken Breast",
    price: 5890/850.0,
    cals: 104/100.0,
  },
  green_curry: { // Grams, one thing is 345
    name: "Green Curry Sauce",
    price: 3499/345.0,
    cals: 57.3/100.0,
  },
  basil: { // Grams, one thing is 100
    name: "Basil",
    price: 1590/100.0,
    cals: 22/100.0,
  }
};

const all_dishes = {
  // Can make per order
  carbonara: {
    shown_name:"(Almost) Carbonara",
    html_id:'carbonara',
    description:`Pasta dish with bacon (traditionally guanciale, hence 'almost') and cheese sauce. 
          The sauce is made by whipping egg yolks & parmesan with the rendered fat of the bacon, giving it a smooth and creamy texture.`,
    amount: 1,
    recipe: {
      egg_yolk: 2,
      fettucine: 1,
      parmesan: 30,
      bacon_thin: 3,
      garlic: 2
    },
    options: {
      fettucine: 1,
      spaghetti: 1,
      bucatini: 1,
      tallarines: 1,
      corbatas: 1,
      macaroni: 1,
      spirals: 1,
      pantrucas: 1,
    },
    extras: {
    },
  },

  // Make jar of sauce
  roasted_pepper_sauce: {
    shown_name:"Roasted Red Pepper & Pistaccio Sauce",
    html_id:'roasted pepper',
    description:`They sell a similar sauce to this in supermarkets in Italy, 
        one of my favorite things I tried there. Very simple and light.`,
    amount: 1/4.0,
    recipe: {
      red_pepper: 1,
      pistaccio: 80,
      olive_oil: 15,
      garlic: 4,
    },
    options: {
      fettucine: 4,
      spaghetti: 4,
      bucatini: 4,
      tallarines: 4,
      corbatas: 4,
      macaroni: 4,
      spirals: 4,
      pantrucas: 4,
    },
    extras: {
    }
  },

  // Make whole pot
  gumbo: {
    shown_name:"Shrimp & Sausage Gumbo",
    html_id:'gumbo',
    description:`Cajun stew made with a very dark roux base and the 'holy trinity' of cajun cooking (onion,
        red pepper, celery). While meat additions vary, this recipe uses large shrimp and seared longaniza. Served over rice.`,
    amount: 1/5.0,
    recipe: {
      red_pepper: 2,
      onion: 1,
      celery: 400,
      flour: 100,
      olive_oil: 20,
      longaniza: 4,
      shrimp_large: 500,
      rice_white: 0.25 * 5
    },
    options: {
      none:1,
    },
    extras: {
    }
  },

  // Can be per order
  putanesca: {
    shown_name:"Putanesca",
    html_id:'putanesca',
    description:`Kitchen sink pasta. Tomato sauce with garlic, anchovies, red pepper, olives, and capers.
        Complex and delicious.`,
    amount: 1,
    recipe: {
      garlic: 1,
      capers: 12,
      olives_black: 40,
      anchovies: 40,
      tomatos_canned: 380,
      olive_oil: 15,
    },
    options: {
      fettucine: 1,
      spaghetti: 1,
      bucatini: 1,
      tallarines: 1,
      corbatas: 1,
      macaroni: 1,
      spirals: 1,
      pantrucas: 1,
    },
    extras: {
    }
  },

  // Can be per order
  buffalo_wings: {
    shown_name:"Buffalo Wings",
    html_id:'buffalo wings',
    description:`KING OF THE GRINGO FOODS. Buttery hot sauce over air-fried chicken wings. 
        Nutritional value was not of great concern when writing this recipe. Very messy. Easily a 10/10 top food.`,
    amount: 1,
    recipe: {
      wings_flats: 8,
      butter: 15,
      misc: 300,
      flour: 20
    },
    options: {
      hot_sauce_mild:30,
      hot_sauce_hot:30,
    },
    extras: {
    }
  },

  // Can be per order
  french_toast: {
    shown_name:"Marraqueta French Toast Sticks",
    html_id:'french toast',
    description:`Crusty old marraqueta dipped in batter and cooked in a pan. Moist and sweet and cinnamony. 
        Comes with maple syrup, the cheap gringo variety is best (more options potentially coming soon).`,
    amount: 1,
    recipe: {
      marraqueta: 1,
      egg: 1,
      milk: 1 / 6.0,
      flour: 15 / 2.0,
      sugar: 25 / 2.0,
      syrup_gringo: 20
    },
    options: {
      cinnamon: 1,
      chocolate: 1,
      coffee: 1
    },
    extras: {
      bacon_thin: 1,
    }
  },

  // Can be per order
  egg_fried: {
    shown_name:"Fried Egg",
    html_id:'fried egg',
    description:`Open up da egg put da egg in da pan add da salt add da peppa put in mouth. Can be over easy or over hard.`,
    amount: 1,
    recipe: {
      egg: 1,
      olive_oil: 7
    },
    options: {
      none:1
    },
    extras: {
      bacon_thin: 1,
    }
  },

  // Can be per order
  ham_and_cheese: {
    shown_name: "Jamon Queso",
    html_id:'ham and cheese',
    description:`A Chileno classic, with a bit of a twist depending on the cheese you pick`,
    amount:1,
    recipe:{
      flour:65,
      olive_oil:15,
      ham: 100
      },
    options:{
      mantecoso:50,
      cheese_blue:33,
      cheese_mozzarella:100,
      quesillo:80
    },
    extras:{
    },
  },

  // per order
  chaparrita: {
    shown_name:"Chaparrita",
    html_id:'chaparrita',
    description:`Empanada of my soul. Sausage and cheese. We would call this a Pig in a Blanket in the US.`,
    amount: 1,
    recipe: {
      flour:65,
      olive_oil:15,
      mantecoso:60
    },
    options: {
      hot_dog:1,
      longaniza:1,
    },
    extras: {
    }
  },

  // per order
  green_curry_empanada: {
    shown_name:"Chicken and Cheese with Thai Green Curry",
    html_id:'green curry empanada',
    description:`Like a regular empanada de pollo queso, but with store-bought (I'm working on it) thai green curry sauce. Might be the best thing I've ever come up with.`,
    amount: 1,
    recipe: {
      flour:65,
      olive_oil:15,
      mantecoso:60,
      chicken_breast:150,
      green_curry: 30,
    },
    options: {
      none:1
    },
    extras: {
    }
  },

  custom_empanada: {
    shown_name:"Custom Empanada",
    html_id:'custom empanada',
    description:`I will wrap literally anything you want in empanada dough and bake it. I will make you a tuna-frutilla-raw rice empanada if you ask for it.`,
    amount: 1,
    recipe: {
      flour:65,
      olive_oil:15,
    },
    options: {
      none:1
    },
    extras: {
    }
  },

  // Egg
  egg: {
    shown_name:"Egg",
    html_id:'egg',
    description:`It's just an egg. Like literally one of those white spheroidal things. I will not cook it or alter it in any way.
        I will hand you a single egg if you ask me to. I have no clue why you would order this.`,
    amount: 1,
    recipe: {
      egg: 1
    },
    options: {
      none:1,
    },
    extras: {
    }
  },

  banana_smoothie: {
    shown_name:"Banana Smoothie",
    html_id:'banana smoothie',
    description:`Yogurt, banana, some sweetener`,
    amount: 1,
    recipe: {
      banana: 1,
      yoghurt: 250
    },
    options: {
      sugar:10,
      stevia:5
    },
    extras: {
      chocolate:5,
      peanut_butter:32
    }
  },
  
  pizza: {
    shown_name:"Pizza",
    html_id:'template',
    description:`Italians invented this circle before the wheel. Too many different topping options, so you can just put whatever you want in the custom box and I'll sort it out.`,
    amount: 1,
    recipe: {
      flour:125,
      olive_oil:25,
      parmesan:20,
      cheese_mozzarella:250,
      tomato:1.5,
      basil:30
    },
    options: {
      none:1,
    },
    extras: {
    }
  },
  
  template: {
    shown_name:"",
    html_id:'template',
    description:``,
    amount: 1,
    recipe: {
      egg: 1
    },
    options: {
      none:1,
    },
    extras: {
    }
  }
};

  function roundnum(num){
    return Math.ceil(num / 50)*50;
  }

  function get_sums(dish, ingredients, net) {
    var pricesum = 0;
    var calsum = 0;
    for (let key in dish) {
      pricesum += ingredients[key].price * dish[key];
      calsum += ingredients[key].cals * dish[key];
    };
    return {price:roundnum(pricesum*net), cals:calsum*net};
  }
  
  function show_results(dish) {
    const optionKeys = Object.keys(dish.options);

    const kcalTotals = optionKeys.map(key => {
      const amount = dish.options[key];
      const kcalPerUnit = ingredient_dict[key]?.cals || 0;
      return amount * kcalPerUnit;
    });

    const priceTotals = optionKeys.map(key => {
      const amount = dish.options[key];
      const pricePerUnit = ingredient_dict[key]?.price || 0;
      return amount * pricePerUnit;
    });

    const minKcal = Math.min(...kcalTotals);
    const minPrice = Math.min(...priceTotals);
    
    let resulti = get_sums(dish.recipe, ingredient_dict, dish.amount);
    document.getElementById(dish.html_id).innerHTML = `${dish.shown_name} <br>Minima: | $${roundnum(resulti.price + (minPrice*dish.amount)).toFixed(0)} |  ${(resulti.cals + (minKcal*dish.amount)).toFixed(0)} cal |`;
  }

  for (const name in all_dishes) {
    const dish = all_dishes[name]
    let results = get_sums(dish.recipe, ingredient_dict, dish.amount);
    all_dishes[name].base_price = results.price
    all_dishes[name].base_cals = results.cals
    show_results(dish)
  }

let counts = [];
let currentSelection = { dish: null };
let savedSelections = [];

function showBox(mode, dish) {
  currentSelection.dish = dish;

  if (mode == 0) {
    document.getElementById("popupBox").style.display = "block";
    document.getElementById("boxtext").innerHTML = all_dishes[dish].description;
  } else {
    document.getElementById("addBox").style.display = "block";

    if (!all_dishes[dish]) {
      console.error(`Dish "${dish}" not found in all_dishes.`);
      return;
    }

    // --- Handle extras (with +/- buttons) ---
    const ingredients = Object.keys(all_dishes[dish].extras);
    const listContainer = document.getElementById('ingredients-list');
    listContainer.innerHTML = "";
    counts = new Array(ingredients.length).fill(0);

    ingredients.forEach((ingredient, index) => {
      const item = document.createElement('div');
      item.className = 'ingredient';

      item.innerHTML = `
        <div class="ingredient-line">
          <div class="ingredient-name">${ingredient_dict[ingredient].name} | $${(ingredient_dict[ingredient]?.price * all_dishes[dish].extras[ingredient] * all_dishes[dish].amount).toFixed(0) || ingredient} | ${(ingredient_dict[ingredient]?.cals * all_dishes[dish].extras[ingredient] * all_dishes[dish].amount).toFixed(0) || ingredient} cals</div>
          <div class="ingredient-controls">
            <button onclick="changeCount(${index}, -1)">-</button>
            <div class="counter" id="counter-${index}">0</div>
            <button onclick="changeCount(${index}, 1)">+</button>
          </div>
        </div>
      `;

      listContainer.appendChild(item);
    });

    // --- Handle mandatory radio options ---
    const ingredients_radio = Object.keys(all_dishes[dish].options || {});
    const listContainer_radio = document.getElementById('ingredients-list-radio');
    listContainer_radio.innerHTML = "";

    ingredients_radio.forEach((ingredient) => {
      const item = document.createElement('div');
      item.className = 'ingredient';
      if (ingredients_radio.length === 1) {
        item.innerHTML = `
          <label class="ingredient-line">
            <span class="ingredient-name">${ingredient_dict[ingredient]?.name || ingredient} | $${(ingredient_dict[ingredient]?.price * all_dishes[dish].options[ingredient] * all_dishes[dish].amount).toFixed(0) || ingredient} | ${(ingredient_dict[ingredient]?.cals* all_dishes[dish].options[ingredient] * all_dishes[dish].amount).toFixed(0) || ingredient} cals</span>
            <input type="radio" name="extra-option-radio-${dish}" value="${ingredient}" checked/>
          </label>
        `;
      } else {
        item.innerHTML = `
          <label class="ingredient-line">
            <span class="ingredient-name">${ingredient_dict[ingredient]?.name || ingredient} | $${(ingredient_dict[ingredient]?.price * all_dishes[dish].options[ingredient] * all_dishes[dish].amount).toFixed(0) || ingredient} | ${(ingredient_dict[ingredient]?.cals * all_dishes[dish].options[ingredient] * all_dishes[dish].amount).toFixed(0) || ingredient} cals</span>
            <input type="radio" name="extra-option-radio-${dish}" value="${ingredient}" onchange="updateTotal()" />
          </label>
        `;
      }

      listContainer_radio.appendChild(item);
    });

    // Reset total
    updateTotal();
  }
}

function changeCount(index, delta) {
  counts[index] = Math.max(0, counts[index] + delta);
  document.getElementById(`counter-${index}`).innerText = counts[index];
  updateTotal();
}

function updateTotal() {
  const dish = currentSelection.dish;
  if (!dish || !all_dishes[dish]) return;

  let total = all_dishes[dish].base_price;
  let caltotal = all_dishes[dish].base_cals;

  // Extras
  const extras = Object.keys(all_dishes[dish].extras);
  extras.forEach((ingredient, index) => {
    const count = counts[index];
    const price = ingredient_dict[ingredient].price * all_dishes[dish].extras[ingredient]  * all_dishes[dish].amount || 0;
    const cals = ingredient_dict[ingredient].calories * all_dishes[dish].extras[ingredient]  * all_dishes[dish].amount || 0;
    total += count * price;
    caltotal += count * cals;
  });

  // Selected radio option
  const selected = document.querySelector(`input[name="extra-option-radio-${dish}"]:checked`);
  if (selected) {
    const radioIngredient = selected.value;
    const optionData = ingredient_dict[radioIngredient];
    if (optionData) {
      total += optionData.price * all_dishes[dish].options[radioIngredient]  * all_dishes[dish].amount || 0;
      caltotal += optionData.cals * all_dishes[dish].options[radioIngredient]  * all_dishes[dish].amount || 0;
    }
  }

  document.getElementById("totals").innerHTML =
    `Totals: $${roundnum(total)} | ${caltotal.toFixed(0)} cal`;
}

//function roundnum(n) {
  //return (Math.round(n * 100) / 100).toFixed(2);
//}

function getCurrentSelection() {
  const dish = currentSelection.dish;
  const extras = {};
  const extraKeys = Object.keys(all_dishes[dish].extras);
  const request = document.getElementById("customRequest").value;

  extraKeys.forEach((ingredient, index) => {
    const count = counts[index];
    if (count > 0) {
      extras[ingredient] = count;
    }
  });

  const selectedOption = document.querySelector(`input[name="extra-option-radio-${dish}"]:checked`);
  const option = selectedOption ? selectedOption.value : null;

  return { dish:dish, extras:extras, option:option, request:request};
}

function saveSelection() {
  const selection = getCurrentSelection();
  if (selection.option == null) {
    document.getElementById("NoOption").innerHTML = `Please Make an Options Choice`
  } else {
    document.getElementById("NoOption").innerHTML = ``
    savedSelections.push(selection);
    updateSubtotal();
    document.getElementById("addBox").style.display = "none";
  }
  //console.log("All saved selections:", savedSelections);
}
function updateSubtotal() {
  let subtotal = 0; // Initialize subtotal
  let calsub = 0;

  savedSelections.forEach(function(order) {  // Corrected parentheses
    subtotal += all_dishes[order.dish].base_price;  // Adding base price for the dish
    calsub += all_dishes[order.dish].base_cals;
    if (order.option) {
      subtotal += ingredient_dict[order.option].price * all_dishes[order.dish].options[order.option] * all_dishes[order.dish].amount;  // Adding price for selected option
      calsub += ingredient_dict[order.option].cals * all_dishes[order.dish].options[order.option] * all_dishes[order.dish].amount;
    }

    Object.keys(order.extras).forEach(function(extra) {  // Corrected the loop to iterate over the keys of the 'extras' object
      subtotal += ingredient_dict[extra].price * order.extras[extra]  * all_dishes[order.dish].amount;  // Adding price for each extra
      calsub += ingredient_dict[extra].cals * order.extras[extra]  * all_dishes[order.dish].amount;
    });
  });

  subtotal = roundnum(subtotal);  // Assuming roundnum rounds the value as needed
  price_total = subtotal;
  cal_total = calsub;
  document.getElementById("subtotal-amount").innerHTML = `${subtotal}`;
}

  function hidepopBox() {
    document.getElementById("popupBox").style.display = "none";
  }
  function hideaddBox() {
    document.getElementById("customRequest").value = ``
    document.getElementById("addBox").style.display = "none";
  }

  function toggleOrderSummary() {
    const box = document.getElementById("orderSummaryBox");
    const list = document.getElementById("orderList");
    const content = document.getElementById("summaryContent");
    // Make the box visible
    box.style.display = "block";

    document.getElementById("receiptTotals").innerHTML = `Totals: $${price_total} | ${cal_total.toFixed(0)} cal`

    // Populate the order list
    list.innerHTML = "";
    savedSelections.forEach((item, index) => {
      const li = document.createElement("li");

      const extrasList = Object.entries(item.extras)
        .map(([extra, count]) => `${ingredient_dict[extra].name} x${count}`)
        .join(", ");

      li.textContent = `${index + 1}. ${all_dishes[item.dish].shown_name} (Option: ${ingredient_dict[item.option]?.name || "None"}, Extras: ${extrasList || "None"}, Custom: ${item.request})`;
      list.appendChild(li);
    });

    // Wait for rendering, then take the screenshot
    setTimeout(() => {
      html2canvas(content).then(canvas => {
        const image = new Image();
        image.src = canvas.toDataURL("image/png");
        image.style.maxWidth = "99%";
        content.parentNode.replaceChild(image, content);
      });
    }, 100); // slight delay to ensure rendering
  }


  function hideOrderSummary() {
    document.getElementById("orderSummaryBox").style.display = "none";
    document.getElementById("orderSummaryBox").innerHTML = `
        <div id="summaryContent">
          <img src="/assets/apuchef.jpg" width="50%">
          <h3>Your Order</h3>
          <ul id="orderList"></ul>
        <h3 id="receiptTotals"></h3>
        </div>
        <button class="close-btn" onclick="hideOrderSummary()">Close</button>
        `
  }

  function toggleEditBox() {
    const box = document.getElementById("editBox");
    const list = document.getElementById("editOrderList");
    const content = document.getElementById("editContent");
    // Make the box visible
    box.style.display = "block";

    renderEditContent()
  }

  function renderEditContent() {
    const box = document.getElementById("editBox");
    const list = document.getElementById("editOrderList");
    const content = document.getElementById("editContent");

  document.getElementById("editReceiptTotals").innerHTML = `Totals: $${price_total} | ${cal_total.toFixed(0)} cal`;

  list.innerHTML = "";

  savedSelections.forEach((item, index) => {
  const li = document.createElement("li");

  const extrasList = Object.entries(item.extras)
    .map(([extra, count]) => `${ingredient_dict[extra].name} x${count}`)
    .join(", ");

  li.textContent = `${index + 1}. ${all_dishes[item.dish].shown_name} (Option: ${ingredient_dict[item.option]?.name || "None"}, Extras: ${extrasList || "None"}, Custom: ${item.request})`;

  // Create the delete (X) button
  const deleteBtn = document.createElement("button");
  deleteBtn.textContent = "Remove";
  deleteBtn.style.marginLeft = "5px";
  deleteBtn.style.color = "red";
  deleteBtn.style.background = "none";
  deleteBtn.style.border = "none";
  deleteBtn.style.fontSize = "1.0em";
  deleteBtn.style.cursor = "pointer";

  // Hook up delete behavior
  deleteBtn.onclick = () => {
    savedSelections.splice(index, 1);
    // re-render the list and recalculate totals
    updateSubtotal();      // or however you recalculate totals
    renderEditContent(); // you can move this whole loop into a function with that name
  };

  li.appendChild(deleteBtn);
  list.appendChild(li);
});
  }


  function hideEditBox() {
    document.getElementById("editBox").style.display = "none";
  }

  function getRandomEntry(arr) {
    return arr[Math.floor(Math.random() * arr.length)];
  }

  //Stuff for the addition of extras
    //function changeCount(index, delta) {
    //  counts[index] = Math.max(0, counts[index] + delta); // Prevent negative counts
    //  document.getElementById(`counter-${index}`).textContent = counts[index];
   // }
  
  const messagelist = ["there is no rat hiding in my hair doing the cooking stop asking",
                       "my name is not and never has been mevin michael moy",
                       "food tastes better if you believe in ghosts",
                       "personally, I wouldn't trust me but I appreciate the sentiment",
                       "look, austria-hungary was dissolved like 100 years ago, but hear me out...",
                       "he who has stolen from the wizards has earned the nat 20 fireball",
                       "looking at the sun is a good idea",
                       "human beings weren't meant to be able to see the moon",
                       "i once saw a man in a gorilla suit dancing in the middle of the street and it changed me",
                       "could you imagine what would happen if brian stevenson didn't do that one thing",
                       "pink is not a real color and i will drown in pepto bismol on that hill",
                       "when the going gets tough i grab a beer",
                       "i don't believe the official story about the mariana trench",
                       "please don't leave me i can't escape this ribbon",
                       "in some cultures, 3*3 could be 10",
                       "i could beat batman in a fight if i went all out",
                       "cheese is literally goblin magic",
                       "if apples grew on trees they'd be cheaper",
                       "i've never met a sandwich too large to finish in one go",
                       "if i could erase one person from existence it would probably be whoever ended myspace",
                       "every good story ends with changing the name of constantinople",
                       "we're talking away. i don't know what i'm to say. i'll say it anyway",
                       "singing in the rain is vastly overrated",
                       "huge fan of turnips here, love those lil guys",
                       "inception actually is as good as they say",
                       "never buy what you can convince a crow to steal for you",
                       "*that one drum part from in the air tonight by phil collins*",
                       "onions and apples are the same thing if you think about it",
                       "i'd put tiramisu and cheesecake on here but i'd get fat again eating leftovers",
                      ];
  document.getElementById("random").innerHTML = getRandomEntry(messagelist); // Random fruit from the list
  
</script>
</html>
